#This powershell script will output each member of an AD Group for a particular Domain Controller
#change the OU below to the required member. 

$SearchBase = "OU=<Organizational Unit 1>,OU=<Organizational Unit 2> Security Contexts,OU=External Users,DC=DC01,DC=DC02,DC=com"
$ADGroups = Get-ADGroup -Server "server.location.com"  -Filter * -SearchBase $SearchBase | % { [ADSI]("LDAP://$_") }
#we have to specify the -Server parameter to make sure we are not running it against the default DC
#although this might not be the case for most people, it just was for my scenario

$Members = @()

foreach ($ADGroup in $ADGroups){
	$Members += $ADGroup.Member |
		Select -Property @{Name="ADGroup";Expression={$ADGroup.cn}},
		@{Name="Member";Expression={$_}}
}

$Members | Select-Object AdGroup, Member,ObjectGUID | Export-Csv -Path "C:\_Support\ADGroupMembers.csv" -NoType 
#change the output directory to a subfolder and filename of your choice on your C: drive.  You will not have access to write to the root, 
#it must be a subfolder
